{"version":3,"sources":["../src/pie_chart_option.js"],"names":["getOption","data","myChart","categories","dp","getCategories","categoriesData","getCategoriesData","reasonsData","getReasonsData","isDurationMode","option","toolbox","show","feature","myTool1","title","icon","onclick","series","toDuration","newOption","utils","copyObject","selected","label","normal","formatter","setOption","saveAsImage","right","tooltip","trigger","params","value","toHrsAndMins","duration","type","color","name","percent","backgroundColor","borderColor","borderWidth","borderRadius","legend","orient","x","selectedMode","radius","labelLine","itemStyle","emphasis","shadowBlur","shadowOffsetX","shadowColor"],"mappings":"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","file":"pie_chart_option.js","sourcesContent":["import * as dp from './data_processor'\nimport * as utils from './utils'\n\nexport function getOption (data, myChart) {\n\n  let categories = dp.getCategories(data) // legends are only for categories\n\n  let categoriesData = dp.getCategoriesData(categories, data)\n  // console.log(categoriesData);\n  \n  let reasonsData = dp.getReasonsData(categories[0], data)\n  // console.log(reasonsData);\n\n  let isDurationMode = false\n\n  let option = {\n    toolbox: {\n      show: true,\n      feature: {\n          show: true,\n          myTool1: {\n              show: true,\n              title: 'duration',\n              icon: 'image://public/plugins/smart-factory-pareto-reason-codes-pie-chart-panel/images/switch.png',\n              onclick: function (){\n                if (!isDurationMode) {\n                  //change the series data to duration mode\n                  option.series[1].data = dp.toDuration(reasonsData)\n                  option.series[0].data = dp.toDuration(categoriesData)\n                  option.toolbox.feature.myTool1.title = 'frequency of occurrences'\n                }else{\n                  //back to occurrences mode                  \n                  option.series[1].data = reasonsData\n                  option.series[0].data = categoriesData\n                  option.toolbox.feature.myTool1.title = 'duration'\n                }\n                const newOption = utils.copyObject(option)\n                newOption.series[0].data[0].selected = true\n                newOption.series[0].label.normal.formatter = option.series[0].label.normal.formatter\n                newOption.series[1].label.normal.formatter = option.series[1].label.normal.formatter\n                myChart.setOption(newOption)\n                isDurationMode = !isDurationMode\n              }\n          },\n          saveAsImage: {\n            show: true,\n            title: 'save as image'\n          }\n      },\n      right: 45\n    },\n    tooltip: {\n      trigger: 'item',\n      formatter: (params) => {\n        let value\n        if (params.data.isDurationMode) {\n          value = dp.toHrsAndMins(params.data.duration)\n        }else {\n          value = params.data.value\n        }\n        let tooltip = '<p style=\"text-align:center;margin:0px;color:#999\">' + params.data.type + '</p>'\n        tooltip += '<div style=\"margin:5px 0px 5px 0px; width:100%; height:1px; background: #999\"></div>'\n        tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:large\">' + params.data.name + ' :</strong> &nbsp;' + value + '&nbsp;&nbsp; <span style=\"color:#eee; border-radius:2px; padding: 2px 4px; background-color:#334455\">' + params.percent + '%</span></p> '\n        return tooltip\n      },\n      backgroundColor: '#eee',\n      borderColor: '#aaa',\n      borderWidth: 1,\n      borderRadius: 4,\n    },\n    legend: {\n      orient: 'vertical',\n      x: 'left',\n      data: categories,\n      formatter: (name) => {\n        return name\n      }\n    },\n    series: [\n      {\n        name: 'Category',\n        type: 'pie',\n        selectedMode: 'single',\n        radius: [0, '30%'],\n        label: {\n          normal: {\n            formatter: params => params.data.name + '\\n' + params.percent + '%'\n          }\n        },\n        labelLine: {\n          normal: {\n            show: true\n          }\n        },\n        data: categoriesData,\n        itemStyle: {\n          emphasis: {\n              shadowBlur: 10,\n              shadowOffsetX: 5,\n              shadowColor: 'rgba(0, 0, 0, 0.5)'\n          }\n        }\n      },\n      {\n        name: 'Reasons',\n        type: 'pie',\n        radius: ['80%', '85%'],\n        label: {\n          normal: {\n            formatter: params => params.data.name + '\\n' + params.percent + '%'\n          }\n        },\n        data: reasonsData\n      }\n    ]\n  }\n\n  return option \n}\n"]}